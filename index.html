<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Pitch Maintenance Evaluation v3</title>
<style>
:root{--bg:#fff;--fg:#111827;--line:#e5e7eb;--muted:#6b7280;--pill:#f3f4f6;}
*{box-sizing:border-box;font-family:system-ui,Segoe UI,Roboto;}
body{background:var(--bg);color:var(--fg);margin:0;padding:20px;}
h1{font-size:22px;margin:0 0 4px;}
h2{font-size:18px;margin:16px 0 6px;}
.card{background:#fff;border:1px solid var(--line);border-radius:14px;padding:16px;}
.tabbar button{padding:8px 12px;border:1px solid var(--line);border-radius:10px;background:#fff;cursor:pointer;}
.tabbar button.active{background:var(--fg);color:#fff;}
.table{width:100%;border-collapse:collapse;}
.table td,.table th{border-bottom:1px solid var(--line);padding:6px;}
.bar{display:inline-block;height:8px;border-radius:4px;background:#d1d5db;margin-left:6px;position:relative;top:1px;width:100px;}
.bar span{display:block;height:100%;background:#111827;border-radius:4px;}
.muted{color:var(--muted);font-size:12px;}
</style>
</head>
<body>
<h1>Pitch Maintenance Evaluation v3</h1>
<p class="muted">Includes visual bars, notes tab, weighted formula, and full reset.</p>

<div class="tabbar">
  <button class="active" data-tab="summary">Summary</button>
  <button data-tab="notes">Notes</button>
</div>

<section id="summary" class="card">
  <h2>Results Overview</h2>
  <table class="table" id="avgTable">
    <thead><tr><th>Category</th><th>Average (1–5)</th></tr></thead>
    <tbody>
      <tr><td>A. Pitch Quality</td><td><span class="val">4.2</span><div class="bar"><span style="width:84%;"></span></div></td></tr>
      <tr><td>B. Maintenance Effectiveness</td><td><span class="val">4.0</span><div class="bar"><span style="width:80%;"></span></div></td></tr>
      <tr><td>C. Overall</td><td><span class="val">4.3</span><div class="bar"><span style="width:86%;"></span></div></td></tr>
    </tbody>
  </table>
  <p><b>Overall Weighted Score:</b> <span id="weightedScore">4.21</span></p>
  <button id="btnResetAll">Full Reset</button>
</section>

<section id="notes" class="card" style="display:none;">
  <h2>All Notes</h2>
  <table class="table">
    <thead><tr><th>Date</th><th>Role</th><th>Name</th><th>Note</th></tr></thead>
    <tbody id="notesBody">
      <tr><td>2025-11-06</td><td>Player</td><td>Ali</td><td>Very good surface quality.</td></tr>
      <tr><td>2025-11-06</td><td>Coach</td><td>Mohamed</td><td>Drainage could improve slightly.</td></tr>
    </tbody>
  </table>
</section>

<script>
// Tabs
document.querySelectorAll('.tabbar button').forEach(btn=>{
  btn.addEventListener('click',()=>{
    document.querySelectorAll('.tabbar button').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    document.querySelectorAll('section').forEach(s=>s.style.display='none');
    document.getElementById(btn.dataset.tab).style.display='block';
  });
});

// Weighted calculation validation (dummy demo values)
function calcWeighted(){
  const data = [
    {role:'head_coach',score:4.3},
    {role:'football_director',score:4.1},
    {role:'technical_staff',score:4.0},
    {role:'player',score:4.2},
    {role:'medical',score:4.1},
    {role:'administrative',score:4.0}
  ];
  const weights = {
    head_coach:20,football_director:20,technical_staff:20,
    player:20,medical:10,administrative:10
  };
  let sumW=0, total=0;
  for(const r of data){
    if(r.score>0){sumW+=weights[r.role]; total+=r.score*weights[r.role];}
  }
  const res=(sumW>0)?(total/sumW).toFixed(2):'–';
  document.getElementById('weightedScore').textContent=res;
}
calcWeighted();

// Reset all data
document.getElementById('btnResetAll').addEventListener('click',()=>{
  if(confirm('This will erase all saved results and notes. Continue?')){
    localStorage.clear();
    alert('All data cleared.');
    location.reload();
  }
});
</script>
</body>
</html>
